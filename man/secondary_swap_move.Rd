% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mcmc_parcel_mcmc_kernels.R
\name{secondary_swap_move}
\alias{secondary_swap_move}
\title{Secondary capacity-balanced swap move}
\usage{
secondary_swap_move(
  state,
  library,
  parcel_graph,
  constraints,
  cap_tolerance = 50,
  neighbor_idx = NULL
)
}
\arguments{
\item{state}{Current state}

\item{library}{Secondary library}

\item{parcel_graph}{igraph object}

\item{constraints}{MBTA constraints}

\item{cap_tolerance}{Capacity tolerance for similar-capacity filtering (default 50)}
}
\value{
List with new_state, accepted, move_type, details
}
\description{
Proposes swapping an existing secondary with another block of similar capacity.
This enables geographic mixing while keeping total capacity roughly constant.
}
\details{
Unlike the neighbor-based replace move, this samples from ALL addable blocks
with similar capacity, enabling longer-range geographic jumps.

Algorithm:
\enumerate{
\item Select a secondary block B_old uniformly from current secondaries
\item Compute state without B_old
\item Get all addable blocks (disjoint + non-adjacent to remaining state)
\item Filter to similar capacity: |cap - cap_old| <= tolerance
\item Select B_new uniformly from similar-capacity set
\item Compute reverse: similar-capacity addable blocks when removing B_new
\item MH ratio = |S_rev| / |S_fwd|
}
}
