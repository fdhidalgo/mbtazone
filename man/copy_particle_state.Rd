% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/smc_particle.R
\name{copy_particle_state}
\alias{copy_particle_state}
\title{Copy Particle State}
\usage{
copy_particle_state(particle)
}
\arguments{
\item{particle}{A ParticleState object}
}
\value{
A new ParticleState object with all state copied
}
\description{
Create a deep copy of a particle for resampling. All state must be copied
to ensure offspring particles don't share references with parents.
}
\details{
\subsection{Critical for Resampling}{

During resampling (PRD Section 4.3.3), particles are duplicated to
concentrate computational effort on high-valuation particles. All state
must be copied to avoid shared references.
}

\subsection{What Gets Copied}{
\itemize{
\item \code{parcel_ids} vector (via \code{c()} to force copy)
\item All numeric state (scalars are copied by value in R)
\item \strong{CRITICAL}: \code{log_proposal_path} must be copied for correct importance weights
}
}

\subsection{Resampling Probability}{

After copying, the offspring's \code{log_proposal_path} must be updated with
the parent selection probability:

\if{html}{\out{<div class="sourceCode">}}\preformatted{offspring$log_proposal_path <- parent$log_proposal_path + log(V_norm_parent)
}\if{html}{\out{</div>}}

This accounts for the resampling decision in the proposal path Q(Ï„).
}
}
\examples{
\dontrun{
# Resampling step
offspring <- copy_particle_state(parent)
offspring$log_proposal_path <- parent$log_proposal_path + log(parent_prob)
}

}
\keyword{internal}
