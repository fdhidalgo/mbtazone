% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mcmc_parcel_library.R
\name{discover_lccs_by_capacity_bands}
\alias{discover_lccs_by_capacity_bands}
\title{Discover LCCs via capacity-stratified BFS sampling}
\usage{
discover_lccs_by_capacity_bands(
  parcel_graph,
  constraints,
  capacity_bands_relative = LCC_CAPACITY_BANDS_RELATIVE,
  samples_per_band = LCC_BAND_SAMPLES_PER_BAND,
  max_attempts_per_band = LCC_BAND_MAX_ATTEMPTS,
  forbidden_parcels = NULL,
  existing_keys = character(0),
  verbose = TRUE
)
}
\arguments{
\item{parcel_graph}{igraph object with capacity/area attributes}

\item{constraints}{MBTA constraints list (min_capacity, min_area, min_density,
min_lcc_fraction)}

\item{capacity_bands_relative}{List of c(low_mult, high_mult) tuples.
Each tuple defines a band as \link{low_mult * min_capacity, high_mult * min_capacity}.
Default: LCC_CAPACITY_BANDS_RELATIVE from parcel_config.R.}

\item{samples_per_band}{Number of BFS samples per band.
Default: LCC_BAND_SAMPLES_PER_BAND.}

\item{max_attempts_per_band}{Maximum BFS attempts before moving on.
Default: LCC_BAND_MAX_ATTEMPTS.}

\item{forbidden_parcels}{Character vector of parcels to exclude from LCCs.
Default: NULL.}

\item{existing_keys}{Character vector of xxhash64 keys to skip (from prior
discoveries like tree enumeration). Default: character(0).}

\item{verbose}{Print progress. Default: TRUE.}
}
\value{
List with:
\itemize{
\item discovered_lccs: data.table with lcc_key, parcel_ids, capacity, area,
capacity_band (integer), tree_count = 0, source = "bfs_stratified"
\item band_stats: data.table summarizing discoveries per band
\item n_total_attempts: total BFS attempts across all bands
\item n_unique_found: unique LCCs found
}
}
\description{
Explicitly targets capacity bands to populate the library with LCCs
in ranges that tree enumeration under-represents. Tree discovery produces
78\% LCCs with capacity > 5000, but the capacity prior (lambda=0.005)
makes the posterior favor LCCs with capacity 1200-2000.
}
\details{
Unlike run_bfs_lcc_supplement() which seeds from tree-discovered LCCs,
this function seeds from random parcels across the graph, enabling
discovery of LCCs in capacity ranges tree enumeration misses.

Algorithm:
\enumerate{
\item For each capacity band \link{cap_low, cap_high}:
a. Select random seed parcels from all eligible parcels
b. BFS-grow toward target capacity within band
c. Validate: capacity in band, area >= min_area, density >= min_density
d. Check connectivity (guaranteed by BFS, but verified)
e. Deduplicate via xxhash64
\item Return all unique LCCs discovered across bands
}
}
