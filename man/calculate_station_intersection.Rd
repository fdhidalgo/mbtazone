% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gis_operations.R
\name{calculate_station_intersection}
\alias{calculate_station_intersection}
\title{Calculate Station Area Intersection}
\usage{
calculate_station_intersection(
  parcels,
  station_areas,
  output_unit = c("sqft", "acres")
)
}
\arguments{
\item{parcels}{An sf object containing parcel geometries. Must be in
EPSG:26986 projection.}

\item{station_areas}{An sf object containing transit station buffer geometries
(typically 0.5-mile radius buffers). Must be in EPSG:26986 projection.}

\item{output_unit}{Character string specifying output units for intersection
area: "sqft" (default) or "acres".}
}
\value{
The input \code{parcels} sf object with an additional column:
\itemize{
\item \code{station_area_sf}: Numeric, area of parcel within station buffers
(in specified units). Parcels with no station overlap get 0, not NA.
}
}
\description{
Calculate the area of each parcel that intersects with MBTA transit station
areas (0.5-mile buffers). Adds a new column \code{station_area_sf} to the parcels
containing intersection area in square feet.
}
\details{
This function performs spatial intersection between parcels and transit station
areas to determine compliance with location requirements. For Rapid Transit
and Commuter Rail communities, a minimum percentage of the district must be
within 0.5-mile station buffers.

The function:
\enumerate{
\item Validates both inputs are in EPSG:26986
\item Uses \code{sf::st_intersection()} for spatial overlay
\item Calculates intersection area for each parcel
\item Handles multiple overlapping station areas (sums total overlap)
\item Returns 0 for parcels outside all station areas (not NA)
}
}
\section{Performance}{

For large parcel datasets (>10,000 parcels), this function uses spatial
indexing to optimize intersection calculations. Expected performance:
<30 seconds for 20,000 parcels.
}

\section{NA Handling}{

\itemize{
\item Parcels outside station areas get \code{station_area_sf = 0} (not NA)
\item Invalid geometries are repaired with \code{sf::st_make_valid()}
\item Empty geometries get \code{station_area_sf = 0}
}
}

\examples{
\dontrun{
# Load parcels and station areas
parcels <- load_municipality("chelsea.zip")
station_areas <- load_transit_stations()

# Calculate station intersection
parcels <- calculate_station_intersection(
  parcels,
  station_areas,
  output_unit = "sqft"
)

# Check how many parcels are in station areas
in_station <- sum(parcels$station_area_sf > 0)
cat("Parcels in station areas:", in_station, "\n")

# Calculate total station area
total_station_area <- sum(parcels$station_area_sf) / 43560
cat("Total area in stations:", total_station_area, "acres\n")
}

}
\seealso{
\code{\link{calculate_station_area_percentage}}, \code{\link{load_transit_stations}}
}
